(()=>{"use strict";var e,t={258:(e,t,r)=>{const a=window.dscc;function n(e){if(!Array.isArray(e))throw new Error("Input data must be an array");var t=new Map;return e.forEach((function(e,r){try{if(!e.date||!e.value)return;var a=(o=e.date,(i=new Date(o)).setHours(0,0,0,0),i.setDate(i.getDate()-i.getDay()),i),n=a.toISOString();t.has(n)||t.set(n,{date:a,value:0,target:null,historicalValue:null,count:0});var l=t.get(n);l.value+=e.value,null!=e.target&&(l.target=(l.target||0)+e.target),null!=e.historicalValue&&(l.historicalValue=(l.historicalValue||0)+e.historicalValue),l.count++}catch(e){}var o,i})),Array.from(t.values()).map((function(e){return{date:e.date,value:e.value/e.count,target:e.target?e.target/e.count:null,historicalValue:e.historicalValue?e.historicalValue/e.count:null}})).sort((function(e,t){return e.date-t.date}))}function l(e){if(!Array.isArray(e)||0===e.length)return null;try{var t,r=new Date(e[e.length-1].date),a=e[e.length-1].value,n=new Date(r.getFullYear(),r.getMonth(),1),l=null===(t=e.find((function(e){return new Date(e.date)>=n})))||void 0===t?void 0:t.historicalValue;return l?(a-l)/l*100:null}catch(e){return null}}function o(e){if(!Array.isArray(e)||0===e.length)return null;try{var t,r=new Date(e[e.length-1].date),a=e[e.length-1].value,n=Math.floor(r.getMonth()/3),l=new Date(r.getFullYear(),3*n,1),o=null===(t=e.find((function(e){return new Date(e.date)>=l})))||void 0===t?void 0:t.historicalValue;return o?(a-o)/o*100:null}catch(e){return null}}function i(e){if(!Array.isArray(e)||0===e.length)return null;try{var t,r=new Date(e[e.length-1].date),a=e[e.length-1].value,n=new Date(r.getFullYear(),0,1),l=null===(t=e.find((function(e){return new Date(e.date)>=n})))||void 0===t?void 0:t.historicalValue;return l?(a-l)/l*100:null}catch(e){return null}}var u=r(27),c=r(623),s=r(983),d=r(26),v=r(98),h=r(233),f=r(90),g=r(662),m=r(454),y=r(846),p=r(947);function w(e,t,r){try{for(;e.firstChild;)e.removeChild(e.firstChild);var a={top:40,right:20,bottom:50,left:60},n=e.clientWidth||600,l=e.clientHeight||400,o=Math.max(n-a.left-a.right,200),i=Math.max(l-a.top-a.bottom,200),g=(0,u.A)(e).append("svg").attr("width",o+a.left+a.right).attr("height",i+a.top+a.bottom).append("g").attr("transform","translate(".concat(a.left,",").concat(a.top,")"));if(r.graphNumber&&g.append("text").attr("x",-a.left).attr("y",-a.top/2).attr("class","graph-number").text("Graph ".concat(r.graphNumber)),!Array.isArray(t)||0===t.length)throw new Error("Invalid or empty data array");var w=(0,m.A)(t,(function(e){return e.date})),D=(0,y.A)(t,(function(e){return Math.max(e.value||0,e.target||0,e.historicalValue||0)}));if(!w[0]||!w[1]||!D)throw new Error("Invalid data ranges");var A=(0,c.A)().domain(w).range([0,o]),k=(0,s.A)().domain([0,1.1*D]).range([i,0]).nice();try{var T,C;!function(e,t,r,a,n){try{var l=(0,f.l7)(t).ticks(n.isWeeklyView?6:12).tickFormat((0,p.DC)(n.isWeeklyView?"%m/%d":"%b %Y"));e.append("g").attr("transform","translate(0,".concat(a,")")).attr("class","x-axis").call(l),e.append("g").attr("class","y-axis").call((0,f.V4)(r))}catch(e){throw e}}(g,A,k,i,r),function(e,t,r,a,n){var l,o=(0,d.A)().x((function(e){return r(e.date)})).y((function(e){return a(e.value)}));e.append("path").datum(t).attr("class","main-line").attr("fill","none").attr("stroke",(null===(l=n.lineColor)||void 0===l||null===(l=l.value)||void 0===l?void 0:l.color)||"#3366CC").attr("stroke-width",2).attr("d",o)}(g,t,A,k,r),null!==(T=r.showHistorical)&&void 0!==T&&T.value&&function(e,t,r,a,n){var l,o=(0,d.A)().defined((function(e){return null!=e.historicalValue})).x((function(e){return r(e.date)})).y((function(e){return a(e.historicalValue)}));e.append("path").datum(t.filter((function(e){return null!=e.historicalValue}))).attr("class","historical-line").attr("fill","none").attr("stroke",(null===(l=n.historicalLineColor)||void 0===l||null===(l=l.value)||void 0===l?void 0:l.color)||"#FF9999").attr("stroke-width",2).attr("stroke-dasharray","4,4").attr("opacity",.7).attr("d",o)}(g,t,A,k,r),null!==(C=r.showTargets)&&void 0!==C&&C.value&&function(e,t,r,a,n){var l,o=(0,v.Ay)().type(h.A).size(64);e.selectAll(".target-triangle").data(t.filter((function(e){return null!=e.target}))).enter().append("path").attr("class","target-triangle").attr("d",o).attr("transform",(function(e){return"translate(".concat(r(e.date),",").concat(a(e.target),")")})).attr("fill",(null===(l=n.targetColor)||void 0===l||null===(l=l.value)||void 0===l?void 0:l.color)||"#00AA00")}(g,t,A,k,r),function(e,t,r,a){e.selectAll(".value-label").data(t).enter().append("text").attr("class","value-label").attr("x",(function(e){return r(e.date)})).attr("y",(function(e){return a(e.value)-10})).attr("text-anchor","middle").text((function(e){return b(e.value)}))}(g,t,A,k)}catch(e){throw e}}catch(t){e.innerHTML='\n      <div class="error-message">\n        Unable to render graph: '.concat(t.message,"\n      </div>\n    ")}}function b(e){try{return null!=e?(0,g.GP)(",.0f")(e):"N/A"}catch(e){return"Error"}}function D(e){try{return null!=e?(0,g.GP)("+.1f")(e)+"%":"N/A"}catch(e){return"Error"}}var A="#3366CC",k=!0,T="#FF9999",C=!0,E="#00AA00",x=1;a.subscribeToData((function(e){try{var t,r,a,u,c,s,d,v,h;if(!e||!e.tables||!e.tables.DEFAULT)throw new Error("No data received from Looker Studio");var f=document.getElementById("container");f||((f=document.createElement("div")).id="container",document.body.appendChild(f)),f.innerHTML="";var g={lineColor:(null===(t=e.style)||void 0===t||null===(t=t.lineColor)||void 0===t||null===(t=t.value)||void 0===t?void 0:t.color)||A,showHistorical:null!==(r=null===(a=e.style)||void 0===a||null===(a=a.showHistorical)||void 0===a?void 0:a.value)&&void 0!==r?r:k,historicalLineColor:(null===(u=e.style)||void 0===u||null===(u=u.historicalLineColor)||void 0===u||null===(u=u.value)||void 0===u?void 0:u.color)||T,showTargets:null!==(c=null===(s=e.style)||void 0===s||null===(s=s.showTargets)||void 0===s?void 0:s.value)&&void 0!==c?c:C,targetColor:(null===(d=e.style)||void 0===d||null===(d=d.targetColor)||void 0===d||null===(d=d.value)||void 0===d?void 0:d.color)||E,graphNumber:(null===(v=e.style)||void 0===v||null===(v=v.graph_number)||void 0===v?void 0:v.value)||x,isWeeklyView:!0},m=function(e){try{var t,r,a=e.tables,n=e.fields;if(null===(t=n.dateDimension)||void 0===t||null===(t=t[0])||void 0===t||!t.name||null===(r=n.valueMeasure)||void 0===r||null===(r=r[0])||void 0===r||!r.name)throw new Error("Required fields (date dimension and value measure) are missing");return a.DEFAULT.map((function(e,t){try{var r,a,l=e[n.dateDimension[0].name],o=e[n.valueMeasure[0].name],i=null!==(r=n.targetMeasure)&&void 0!==r&&r[0]?e[n.targetMeasure[0].name]:null,u=null!==(a=n.historicalValueMeasure)&&void 0!==a&&a[0]?e[n.historicalValueMeasure[0].name]:null,c=new Date(l);if(isNaN(c.getTime()))throw new Error("Invalid date value at row ".concat(t+1,": ").concat(l));var s=parseFloat(o);return isNaN(s),{date:c,value:s||0,target:i&&parseFloat(i)||null,historicalValue:u&&parseFloat(u)||null}}catch(e){return null}})).filter((function(e){return null!==e}))}catch(e){throw new Error("Failed to parse data: ".concat(e.message))}}(e);if(!m||0===m.length)return void(f.innerHTML='<div class="error">No valid data available to display</div>');var y=function(e,t){if(!Array.isArray(e))throw new Error("Input data must be an array");if("number"!=typeof t||t<1)throw new Error("Number of weeks must be a positive number");return 0===e.length?[]:e.slice(-Math.min(t,e.length))}(n(m),6),p=function(e){if(!Array.isArray(e)||0===e.length)return{weekOverWeek:null,yearOverYear:null,monthToDate:null,quarterToDate:null,yearToDate:null};try{var t,r=e[e.length-1].value,a=null===(t=e[e.length-2])||void 0===t?void 0:t.value,n=e[e.length-1].historicalValue;return{weekOverWeek:null!=a?(r-a)/a*100:null,yearOverYear:null!=n?(r-n)/n*100:null,monthToDate:l(e),quarterToDate:o(e),yearToDate:i(e)}}catch(e){return{weekOverWeek:null,yearOverYear:null,monthToDate:null,quarterToDate:null,yearToDate:null}}}(y);if(!y||0===y.length)return void(f.innerHTML='<div class="error">Insufficient data for visualization</div>');w(f,y,g);var M=null===(h=y[y.length-1])||void 0===h?void 0:h.value;!function(e,t){try{var r=document.createElement("div");r.className="box-scores",[{label:"Last Week",value:b(t.lastWeek)},{label:"WoW",value:D(t.wow)},{label:"YoY",value:D(t.yoy)},{label:"MTD",value:D(t.mtd)},{label:"QTD",value:D(t.qtd)},{label:"YTD",value:D(t.ytd)}].forEach((function(e){var t=document.createElement("div");t.className="score-item";var a=document.createElement("div");a.className="score-label",a.textContent=e.label;var n=document.createElement("div");n.className="score-value",n.textContent=e.value,t.appendChild(a),t.appendChild(n),r.appendChild(t)})),e.appendChild(r)}catch(t){e.innerHTML+='\n      <div class="error-message">\n        Unable to render box scores: '.concat(t.message,"\n      </div>\n    ")}}(f,{lastWeek:M||0,wow:p.weekOverWeek,yoy:p.yearOverYear,mtd:p.monthToDate,qtd:p.quarterToDate,ytd:p.yearToDate})}catch(e){var V=document.getElementById("container");V&&(V.innerHTML='\n        <div class="error">\n          Unable to display visualization. Please check your data configuration.\n          '.concat(e.message?"<br>Error: ".concat(e.message):"","\n        </div>\n      "))}}),{transform:a.objectTransform,style:!0})}},r={};function a(e){var n=r[e];if(void 0!==n)return n.exports;var l=r[e]={exports:{}};return t[e](l,l.exports,a),l.exports}a.m=t,e=[],a.O=(t,r,n,l)=>{if(!r){var o=1/0;for(s=0;s<e.length;s++){for(var[r,n,l]=e[s],i=!0,u=0;u<r.length;u++)(!1&l||o>=l)&&Object.keys(a.O).every((e=>a.O[e](r[u])))?r.splice(u--,1):(i=!1,l<o&&(o=l));if(i){e.splice(s--,1);var c=n();void 0!==c&&(t=c)}}return t}l=l||0;for(var s=e.length;s>0&&e[s-1][2]>l;s--)e[s]=e[s-1];e[s]=[r,n,l]},a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={397:0};a.O.j=t=>0===e[t];var t=(t,r)=>{var n,l,[o,i,u]=r,c=0;if(o.some((t=>0!==e[t]))){for(n in i)a.o(i,n)&&(a.m[n]=i[n]);if(u)var s=u(a)}for(t&&t(r);c<o.length;c++)l=o[c],a.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return a.O(s)},r=self.webpackChunklooker_custom_graphs=self.webpackChunklooker_custom_graphs||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var n=a.O(void 0,[121],(()=>a(258)));n=a.O(n);var l=window;for(var o in n)l[o]=n[o];n.__esModule&&Object.defineProperty(l,"__esModule",{value:!0})})();